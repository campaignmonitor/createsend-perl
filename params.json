{"name":"createsend-perl","tagline":"A Perl library for the Campaign Monitor API ","body":"# createsend-perl [![Build Status](https://secure.travis-ci.org/campaignmonitor/createsend-perl.png?branch=master)][travis]\r\nA Perl library for the [Campaign Monitor API](http://www.campaignmonitor.com/api/).\r\n\r\n[travis]: http://travis-ci.org/campaignmonitor/createsend-perl\r\n\r\n## Installation\r\n\r\nDownload and install using CPAN:\r\n\r\n```\r\ncpan Net::CampaignMonitor\r\n```\r\n\r\n## Authenticating\r\n\r\nThe Campaign Monitor API supports authentication using either OAuth or an API key.\r\n\r\n### Using OAuth\r\n\r\nThis library helps you authenticate using OAuth, as described in the Campaign Monitor API [documentation](http://www.campaignmonitor.com/api/getting-started/#authenticating_with_oauth). You may also wish to reference this Perl [example application](https://github.com/jdennes/perlcreatesendoauthtest/). The authentication process is described below.\r\n\r\nThe first thing your application should do is redirect your user to the Campaign Monitor authorization URL where they will have the opportunity to approve your application to access their Campaign Monitor account. You can get this authorization URL by using `Net::CampaignMonitor->authorize_url()`, like so:\r\n\r\n```perl\r\nuse Net::CampaignMonitor;\r\n\r\nmy $authorize_url = Net::CampaignMonitor->authorize_url(\r\n  client_id => 'Client ID for your application',\r\n  redirect_uri => 'Redirect URI for your application',\r\n  scope => 'The permission level your application requires',\r\n  state => 'Optional state data to be included'\r\n);\r\n# Redirect your users to $authorize_url.\r\n```\r\n\r\nIf your user approves your application, they will then be redirected to the `redirect_uri` you specified, which will include a `code` parameter, and optionally a `state` parameter in the query string. Your application should implement a handler which can exchange the code passed to it for an access token, using `Net::CampaignMonitor->exchange_token()` like so:\r\n\r\n```perl\r\nuse Net::CampaignMonitor;\r\n\r\nmy $token_details = Net::CampaignMonitor->exchange_token(\r\n  client_id => 'Client ID for your application',\r\n  client_secret => 'Client Secret for your application',\r\n  redirect_uri => 'Redirect URI for your application',\r\n  code => 'A unique code for your user' # Get the code parameter from the query string\r\n);\r\n# Save $token_details->{access_token}, $token_details->{expires_in}, and $token_details->{refresh_token}\r\n```\r\n\r\nOnce you have an access token and refresh token for your user, you can authenticate and make further API calls like so:\r\n\r\n```perl\r\nuse Net::CampaignMonitor;\r\nmy $cm = Net::CampaignMonitor->new({\r\n  access_token => 'your access token',\r\n  refresh_token => 'your refresh token',\r\n  secure  => 1,\r\n});\r\nmy $clients = $cm->account_clients();\r\n```\r\n\r\nAll OAuth tokens have an expiry time, and can be renewed with a corresponding refresh token. If your access token expires when attempting to make an API call, your code should handle the case when a `401 Unauthorized` response is returned with a Campaign Monitor error code of `121: Expired OAuth Token`. Here's an example of how you could do this:\r\n\r\n```perl\r\nuse Net::CampaignMonitor;\r\nmy $cm = Net::CampaignMonitor->new({\r\n  access_token => 'your access token',\r\n  refresh_token => 'your refresh token',\r\n  secure  => 1,\r\n});\r\nmy $clients = $cm->account_clients();\r\n\r\n# If you receive '121: Expired OAuth Token', refresh the access token\r\nif ($clients->{code} eq '401' && $clients->{response}->{Code} eq '121') {\r\n  my $result = $cm->refresh_token();\r\n  # Save $result->{access_token}, $result->{expires_in}, and $result->{refresh_token}\r\n  $clients = $cm->account_clients(); # Make the call again\r\n}\r\n```\r\n\r\n### Using an API key\r\n\r\n```perl\r\nuse Net::CampaignMonitor;\r\nmy $cm = Net::CampaignMonitor->new({\r\n  api_key => 'abcd1234abcd1234abcd1234',\r\n  secure  => 1,\r\n});\r\nmy $clients = $cm->account_clients();\r\n```\r\n\r\n## Basic usage\r\n\r\nThis example of listing all your clients and their campaigns demonstrates basic usage of the library and the data returned from the API.\r\n\r\n```perl\r\nuse Net::CampaignMonitor;\r\n\r\nmy $cm = Net::CampaignMonitor->new(\r\n  secure => 1,\r\n  access_token => 'your access token',\r\n  refresh_token => 'your refresh token'\r\n);\r\n\r\nforeach $cl (@{$cm->account_clients()->{response}}) {\r\n  print \"Client: $cl->{Name}\\n\";\r\n  print \"- Campaigns:\\n\";\r\n  foreach $ca (@{$cm->client_campaigns($cl->{ClientID})->{response}}) {\r\n    print \"  - $ca->{Subject}\\n\";\r\n  }\r\n}\r\n```\r\n\r\n## Documentation\r\n\r\nFull documentation of the module is available on [CPAN](http://search.cpan.org/dist/Net-CampaignMonitor/lib/Net/CampaignMonitor.pm) or by using `perldoc`:\r\n\r\n```\r\nperldoc Net::CampaignMonitor\r\n```\r\n\r\n## Contributing\r\n\r\nPlease check the [guidelines for contributing](https://github.com/campaignmonitor/createsend-perl/blob/master/CONTRIBUTING.md) to this repository.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}